/*! saleman-webclient 2015-10-09 */
function loadApplication(){angular.bootstrap(document.body,["saleman"]),$("#appPreloader").css("display","none"),$("#hiden").css("display","block")}jQuery(document).ready(function(){jQuery(".button-collapse").sideNav();var a=localStorage.getItem("app_cache");a?(a=JSON.parse(a),a.tokens&&a.tokens.refresh?$.ajax({url:"http://185.87.49.173:8080/saleman/oauth/token?grant_type=refresh_token&client_id=web-client&refresh_token="+a.tokens.refresh,dataType:"json",contentType:"application/json",success:function(a){var b={accessToken:a.access_token,refreshToken:a.refresh_token,expiresIn:a.expires_in};$.ajax({url:"http://185.87.49.173:8080/saleman/api/account/getInfo?access_token="+a.access_token,dataType:"json",method:"POST",contentType:"application/json",success:function(a){b.email=a.account.email,b.firstname=a.account.firstname,b.lastname=a.account.lastname,b.patron=a.account.patron,b.getFullName=function(){return this.lastname+" "+this.firstname+" "+this.patron},b.perms={},$.each(a.account,function(a,c){var d=a.indexOf("Permission");-1!=d&&(b.perms[a.substring(0,d)]=c)}),b.isAdmin=a.account.admin,b.blocked=a.company.blocked,b.nextPayment=a.account.next_payment;var c=CryptoJS.enc.Utf8.parse(b.email+b.getFullName());b.cipherKey=CryptoJS.enc.Base64.stringify(c),angular.currentUser=b,loadApplication()},error:function(){loadApplication()}})},error:function(){loadApplication()}}):loadApplication()):loadApplication()});